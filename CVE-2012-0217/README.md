### CVE-2012-0217

#### 描述

The x86-64 kernel system-call functionality in Xen 4.1.2 and earlier, as used in Citrix XenServer 6.0.2 and earlier and other products; Oracle Solaris 11 and earlier; illumos before r13724; Joyent SmartOS before 20120614T184600Z; FreeBSD before 9.0-RELEASE-p3; NetBSD 6.0 Beta and earlier; Microsoft Windows Server 2008 R2 and R2 SP1 and Windows 7 Gold and SP1; and possibly other operating systems, when running on an Intel processor, incorrectly uses the sysret path in cases where a certain address is not a canonical address, which allows local users to gain privileges via a crafted application. NOTE: because this issue is due to incorrect use of the Intel specification, it should have been split into separate identifiers; however, there was some value in preserving the original mapping of the multi-codebase coordinated-disclosure effort to a single identifier.

#### 影响版本

| Product             | Version | Update | Edition | Tested             |
| ------------------- | ------- | ------ | ------- | ------------------ |
| Windows 7           |         | SP1    | X64     |                    |
| Windows 7           |         |        | X64     |                    |
| Windows Server 2003 |         | SP2    |         |                    |
| Windows Server 2008 | R2      |        | X64     |                    |
| Windows Server 2008 | R2      | SP1    | X64     | :heavy_check_mark: |
| Windows Xp          |         | SP3    |         |                    |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2012-0217
```

#### 利用方式

编译环境

- VS2019（V100）X64 Release

测试系统windows server 2008 R2 ps1 x64

![20](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2012-0217_win2008_x64.gif?raw=true)

