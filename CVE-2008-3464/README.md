### CVE-2008-3464

#### 描述

afd.sys in the Ancillary Function Driver (AFD) component in Microsoft Windows XP SP2 and SP3 and Windows Server 2003 SP1 and SP2 does not properly validate input sent from user mode to the kernel, which allows local users to gain privileges via a crafted application, as demonstrated using crafted pointers and lengths that bypass intended ProbeForRead and ProbeForWrite restrictions, aka "AFD Kernel Overwrite Vulnerability."

#### 影响版本

| Product             | Version      | Update | Edition          | Tested |
| ------------------- | ------------ | ------ | ---------------- | ------ |
| Windows 2003 Server |              | SP2    |                  |        |
| Windows 2003 Server |              | SP2    | Itanium          |        |
| Windows 2003 Server |              | SP2    | X64              |        |
| Windows 2003 Server |              |        | X64              |        |
| Windows 2003 Server |              | SP1    | Itanium          |        |
| Windows 2003 Server | Professional | SP3    |                  |        |
| Windows Xp          |              | SP2    | Professional X64 |        |
| Windows Xp          |              | SP3    |                  |        |
| Windows Xp          |              |        | Professional X64 |        |
| Windows Xp          |              | SP2    |                  |        |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2008-3464
```

#### 利用方式

只找到可执行exe文件，测试系统windows server 2003 sp2 x86



![26](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2008-3464_win2003_x86.gif?raw=true)

